$(function(){function t(){$("[emory-form-timeout-submit]").each(function(){var t=$(this);if(!t.attr("[emory-form-onload-submit]")||!t.attr("[emory-form-onload-submit]").length){var r=t.attr("emory-form-timeout-submit");if(t.removeAttr("emory-form-timeout-submit"),r.length){var a=""+Math.floor(999999999*Math.random())+Date.now();t.attr("emory-form-timeout-id",a),setTimeout(function(){e(a)},parseFloat(r))}}})}function e(t){var e=$('[emory-form-timeout-id="'+t+'"]');e.length&&(e.attr("emory-form-timeout-submit-input-name")&&e.attr("emory-form-timeout-submit-input-value")&&e.find('input[name="'+e.attr("emory-form-timeout-submit-input-name")+'"]').val(e.attr("emory-form-timeout-submit-input-value")),e.attr("emory-form-timeout-submit-action")&&(e.attr("action",e.attr("emory-form-timeout-submit-action")),e.attr("emory-form-timeout-submit-action-fallback")&&e.attr("action-fallback",$actor.attr("emory-form-timeout-submit-action-fallback"))),$loadingTarget=!1,$loadingTarget=e.attr("emory-form-loading-target")?$(e.attr("emory-form-result-target")):e.parent(),$loadingTarget.addClass("emory-loading"),e.is("[emory-form-ajax]")?a(e):e.submit())}function r(t){$form=t.closest("form"),t.attr("emory-form-submit-input-name")&&t.attr("emory-form-submit-input-value")&&$form.find('input[name="'+t.attr("emory-form-submit-input-name")+'"]').val(t.attr("emory-form-submit-input-value")),t.attr("emory-form-submit-action")&&($form.attr("action",t.attr("emory-form-submit-action")),t.attr("emory-form-submit-action-fallback")&&$form.attr("action-fallback",t.attr("emory-form-submit-action-fallback"))),t.is("[emory-form-submit-ajax]")&&!$form.is("[emory-form-ajax]")?$form.attr("emory-form-ajax","true"):t.is("[emory-form-submit-normal]")&&$form.is("[emory-form-ajax]")&&$form.removeAttr("emory-form-ajax"),$loadingTarget=!1,$loadingTarget=$form.attr("emory-form-loading-target")?$($form.attr("emory-form-result-target")):$form.parent(),$loadingTarget.addClass("emory-loading"),$form.is("[emory-form-ajax]")?a($form):$form.submit()}function a(t){if($resultTarget=!1,$resultTarget=t.attr("emory-form-result-target")?$(t.attr("emory-form-result-target")):t.parent(),y($resultTarget,t.attr("emory-form-transition")),t.find('input[type="file"]').length)return"FormData"in window?n(t):o(t);var e={};t.find('input[type="hidden"], input[type="text"], input[type="password"], input[type="date"], input[type="datetime"], input[type="datetime-local"], input[type="month"], input[type="week"], input[type="email"], input[type="number"], input[type="search"], input[type="tel"], input[type="time"], input[type="url"], select, textarea').each(function(){e[$(this).attr("name")]=$(this).val()});var r={};t.find('input[type="checkbox"], input[type="radio"]').each(function(){$(this).is(":checked")&&(r[$(this).attr("name")]=r[$(this).attr("name")]?r[$(this).attr("name")]+","+$(this).val():$(this).val())});for(checkboxName in r)e[checkboxName]=r[checkboxName];$.ajax({url:t.attr("action"),type:"POST",data:$.param(e),dataType:"json",success:function(e){return i(e,t)},error:function(e,r,a){return m(e,r,a,t)}})}function o(t){return t.attr("action-fallback")?(t.attr("action",t.attr("action-fallback")),t.attr("enctype","multipart/form-data"),t.prepend($('<input type="hidden" name="MAX_FILE_SIZE" value="25000000" />')),t.attr("method","POST"),void t.submit()):($resultTarget=!1,$resultTarget=t.attr("emory-form-result-target")?$(t.attr("emory-form-result-target")):t.parent(),p($resultTarget,"Error: missing fallback request target.  Please contact support.","error",t.attr("emory-form-transition")))}function n(t){var e=new FormData;e.append("MAX_FILE_SIZE","25000000"),t.find('input[type="hidden"], input[type="text"], input[type="password"], input[type="date"], input[type="datetime"], input[type="datetime-local"], input[type="month"], input[type="week"], input[type="email"], input[type="number"], input[type="search"], input[type="tel"], input[type="time"], input[type="url"], select, textarea').each(function(){e.append($(this).attr("name"),$(this).val())});var r={};t.find('input[type="checkbox"]').each(function(){$(this).is(":checked")&&(r[$(this).attr("name")]=r[$(this).attr("name")]?r[$(this).attr("name")]+","+$(this).val():$(this).val())});for(checkboxName in r)e.append(checkboxName,r[checkboxName]);t.find('input[type="file"]').each(function(){var t=$(this).get(0);e.append($(this).attr("name"),t.files[0])}),$.ajax({url:t.attr("action"),type:"POST",data:e,processData:!1,contentType:!1,dataType:"json",success:function(e){return i(e,t)},error:function(e,r,a){return m(e,r,a,t)}})}function i(t,e){return t.callback_url?void(t.callback_url==window.location.href?window.location.reload(!0):window.location.href=t.callback_url):($loadingTarget=e.attr("emory-form-loading-target")?$(e.attr("emory-form-result-target")):e.parent(),$loadingTarget.removeClass("emory-loading"),$resultTarget=!1,$resultTarget=e.attr("emory-form-result-target")?$(e.attr("emory-form-result-target")):e.parent(),t.success?s(t,e):p($resultTarget,t.error,"error",e.attr("emory-form-transition")))}function m(t,e,r,a){return $loadingTarget=a.attr("emory-form-loading-target")?$(a.attr("emory-form-result-target")):a.parent(),$loadingTarget.removeClass("emory-loading"),$resultTarget=!1,$resultTarget=a.attr("emory-form-result-target")?$(a.attr("emory-form-result-target")):a.parent(),p($resultTarget,"Request error: "+e,"info",a.attr("emory-form-transition"))}function s(t,e){return e.attr("emory-form-ajax-success-pre-hide-target")?void g($(e.attr("emory-form-ajax-success-pre-hide-target")),e.attr("emory-form-transition"),function(){return u(t,e)}):u(t,e)}function u(t,e){return e.attr("emory-form-ajax-success-pre-show-target")?void h($(e.attr("emory-form-ajax-success-pre-show-target")),e.attr("emory-form-transition"),function(){return f(t,e)}):f(t,e)}function f(t,e){$slideDownQueue=$(),t.message&&($resultTarget=!1,$resultTarget=e.attr("emory-form-result-target")?$(e.attr("emory-form-result-target")):e.parent(),p($resultTarget,t.message,"success",e.attr("emory-form-transition")));for(viewIndex in t.data.views)$newView=$(t.data.views[viewIndex]),$newView.hide(),$slideDownQueue.add($newView),e.attr("emory-form-ajax-success-view-"+viewIndex+"-replace-target")?($oldView=$(e.attr("emory-form-ajax-success-view-"+viewIndex+"-replace-target")),$oldView.after($newView),$oldView.remove()):e.attr("emory-form-ajax-success-view-"+viewIndex+"-prepend-target")?($target=$(e.attr("emory-form-ajax-success-view-"+viewIndex+"-prepend-target")),$target.prepend($newView)):e.attr("emory-form-ajax-success-view-"+viewIndex+"-append-target")&&($target=$(e.attr("emory-form-ajax-success-view-"+viewIndex+"-append-target")),$target.append($newView)),e.attr("emory-form-ajax-success-view-"+viewIndex+"-fire-event")?h($newView,e.attr("emory-form-transition"),function(){$newView.trigger(e.attr("emory-form-ajax-success-view-"+viewIndex+"-fire-event"))}):h($newView,e.attr("emory-form-transition"));return $slideDownQueue.length?void h($slideDownQueue,e.attr("emory-form-transition"),function(){c(t,e)}):c(t,e)}function c(t,e){return e.attr("emory-form-ajax-success-post-hide-target")?void g($(e.attr("emory-form-ajax-success-post-hide-target")),e.attr("emory-form-transition"),function(){return l(t,e)}):l(t,e)}function l(t,e){return e.attr("emory-form-ajax-success-post-show-target")?void h($(e.attr("emory-form-ajax-success-post-show-target")),e.attr("emory-form-transition"),function(){return d(t,e)}):d(t,e)}function d(t,e){e.attr("emory-form-ajax-success-callback")&&window[e.attr("emory-form-ajax-success-callback")](t,e)}function p(t,e,r,a,o){r||(r="info"),o||(o=function(){});var n=$('<div data-alert="" class="alert-box '+r+'">'+e+'<a href="#" class="close">Ã—</a></div>');n.css("display","none"),t.prepend(n),h(n,a,o)}function y(t,e){t.children(".alert-box").each(function(){var t=$(this);g(t,e,function(){t.remove()})})}function g(t,e,r){return(!e||Array("slide","fade").indexOf(e)<0)&&(e="slide"),r||(r=function(){}),"slide"==e?t.slideUp().promise().done(r):"fade"==e?t.fadeOut().promise().done(r):void 0}function h(t,e,r){return(!e||Array("slide","fade").indexOf(e)<0)&&(e="slide"),r||(r=function(){}),"slide"==e?t.slideDown().promise().done(r):"fade"==e?t.fadeIn().promise().done(r):void 0}$(document).on("click","[emory-form-click-submit]",function(t){t.preventDefault(),r($(this))}),$(document).on("change","[emory-form-change-submit]",function(t){t.preventDefault(),r($(this))}),$(document).on("keydown","[emory-form-enter-submit]",function(t){var e=t.keyCode||t.which;return 13==e?(r($(this)),!1):void 0}),$(document).on("valid.fndtn.abide","[emory-form-abide-submit]",function(){r($(this))}),setInterval(function(){t()},5e3),$("[emory-form-onload-submit]").each(function(){var t=$(this);$loadingTarget=!1,$loadingTarget=t.attr("emory-form-loading-target")?$(t.attr("emory-form-result-target")):t.parent(),$loadingTarget.addClass("emory-loading"),t.is("[emory-form-ajax]")?a(t):t.submit()})});