$(function(){function t(){$("[emory-form-timeout-submit]").each(function(){var t=$(this);if(!t.attr("[emory-form-onload-submit]")||!t.attr("[emory-form-onload-submit]").length){var e=t.attr("emory-form-timeout-submit");if(t.removeAttr("emory-form-timeout-submit"),e.length){var a=""+Math.floor(999999999*Math.random())+Date.now();t.attr("emory-form-timeout-id",a),setTimeout(function(){r(a)},parseFloat(e))}}})}function r(t){var r=$('[emory-form-timeout-id="'+t+'"]');r.length&&(r.attr("emory-form-timeout-submit-input-name")&&r.attr("emory-form-timeout-submit-input-value")&&r.find('input[name="'+r.attr("emory-form-timeout-submit-input-name")+'"]').val(r.attr("emory-form-timeout-submit-input-value")),r.attr("emory-form-timeout-submit-action")&&(r.attr("action",r.attr("emory-form-timeout-submit-action")),r.attr("emory-form-timeout-submit-action-fallback")&&r.attr("action-fallback",$actor.attr("emory-form-timeout-submit-action-fallback"))),$loadingTarget=!1,$loadingTarget=r.attr("emory-form-loading-target")?$(r.attr("emory-form-loading-target")):r.parent(),$loadingTarget.addClass("emory-loading"),r.is("[emory-form-ajax]")?a(r):r.submit())}function e(t){$form=t.closest("form"),t.attr("emory-form-submit-input-name")&&t.attr("emory-form-submit-input-value")&&$form.find('input[name="'+t.attr("emory-form-submit-input-name")+'"]').val(t.attr("emory-form-submit-input-value")),t.attr("emory-form-submit-action")&&($form.attr("action",t.attr("emory-form-submit-action")),t.attr("emory-form-submit-action-fallback")&&$form.attr("action-fallback",t.attr("emory-form-submit-action-fallback"))),t.is("[emory-form-submit-ajax]")&&!$form.is("[emory-form-ajax]")?$form.attr("emory-form-ajax","true"):t.is("[emory-form-submit-normal]")&&$form.is("[emory-form-ajax]")&&$form.removeAttr("emory-form-ajax"),$loadingTarget=!1,$loadingTarget=$form.attr("emory-form-loading-target")?$($form.attr("emory-form-loading-target")):$form.parent(),$loadingTarget.addClass("emory-loading"),$form.is("[emory-form-ajax]")?a($form):$form.submit()}function a(t){if($resultTarget=!1,$resultTarget=t.attr("emory-form-result-target")?$(t.attr("emory-form-result-target")):t.parent(),g($resultTarget,t.attr("emory-form-transition")),t.find('input[type="file"]').length)return"FormData"in window?n(t):o(t);var r={};t.find('input:not([type="checkbox"]):not([type="radio"]), select, textarea').each(function(){r[$(this).attr("name")]=$(this).val()});var e={};t.find('input[type="checkbox"], input[type="radio"]').each(function(){$(this).is(":checked")&&(e[$(this).attr("name")]=e[$(this).attr("name")]?e[$(this).attr("name")]+","+$(this).val():$(this).val())});for(checkboxName in e)r[checkboxName]=e[checkboxName];$.ajax({url:t.attr("action"),type:"POST",data:$.param(r),dataType:"json",success:function(r){return i(r,t)},error:function(r,e,a){return m(r,e,a,t)}})}function o(t){return t.attr("action-fallback")?(t.attr("action",t.attr("action-fallback")),t.attr("enctype","multipart/form-data"),t.prepend($('<input type="hidden" name="MAX_FILE_SIZE" value="25000000" />')),t.attr("method","POST"),void t.submit()):($resultTarget=!1,$resultTarget=t.attr("emory-form-result-target")?$(t.attr("emory-form-result-target")):t.parent(),y($resultTarget,"Error: missing fallback request target.  Please contact support.","error",t.attr("emory-form-transition")))}function n(t){var r=new FormData;r.append("MAX_FILE_SIZE","25000000"),t.find('input:not([type="checkbox"]):not([type="radio"]):not([type="file"]), select, textarea').each(function(){r.append($(this).attr("name"),$(this).val())});var e={};t.find('input[type="checkbox"], input[type="radio"]').each(function(){$(this).is(":checked")&&(e[$(this).attr("name")]=e[$(this).attr("name")]?e[$(this).attr("name")]+","+$(this).val():$(this).val())});for(checkboxName in e)r.append(checkboxName,e[checkboxName]);t.find('input[type="file"]').each(function(){var t=$(this).get(0);r.append($(this).attr("name"),t.files[0])}),$.ajax({url:t.attr("action"),type:"POST",data:r,processData:!1,contentType:!1,dataType:"json",success:function(r){return i(r,t)},error:function(r,e,a){return m(r,e,a,t)}})}function i(t,r){return t.callback_url?void(t.callback_url==window.location.href?window.location.reload(!0):window.location.href=t.callback_url):($loadingTarget=r.attr("emory-form-loading-target")?$(r.attr("emory-form-loading-target")):r.parent(),$loadingTarget.removeClass("emory-loading"),$resultTarget=!1,$resultTarget=r.attr("emory-form-result-target")?$(r.attr("emory-form-result-target")):r.parent(),t.success?s(t,r):y($resultTarget,t.error,"error",r.attr("emory-form-transition")))}function m(t,r,e,a){return $loadingTarget=a.attr("emory-form-loading-target")?$(a.attr("emory-form-loading-target")):a.parent(),$loadingTarget.removeClass("emory-loading"),$resultTarget=!1,$resultTarget=a.attr("emory-form-result-target")?$(a.attr("emory-form-result-target")):a.parent(),y($resultTarget,"Request error: "+r,"info",a.attr("emory-form-transition"))}function s(t,r){return r.attr("emory-form-ajax-success-pre-hide-target")?void p($(r.attr("emory-form-ajax-success-pre-hide-target")),r.attr("emory-form-transition"),function(){return u(t,r)}):u(t,r)}function u(t,r){return r.attr("emory-form-ajax-success-pre-show-target")?void h($(r.attr("emory-form-ajax-success-pre-show-target")),r.attr("emory-form-transition"),function(){return f(t,r)}):f(t,r)}function f(t,r){$slideDownQueue=$(),t.message&&($resultTarget=!1,$resultTarget=r.attr("emory-form-result-target")?$(r.attr("emory-form-result-target")):r.parent(),y($resultTarget,t.message,"success",r.attr("emory-form-transition")));for(viewIndex in t.data.views)$newView=$(t.data.views[viewIndex]),$newView.hide(),$slideDownQueue.add($newView),r.attr("emory-form-ajax-success-view-"+viewIndex+"-replace-target")?($oldView=$(r.attr("emory-form-ajax-success-view-"+viewIndex+"-replace-target")),$oldView.after($newView),$oldView.remove()):r.attr("emory-form-ajax-success-view-"+viewIndex+"-prepend-target")?($target=$(r.attr("emory-form-ajax-success-view-"+viewIndex+"-prepend-target")),$target.prepend($newView)):r.attr("emory-form-ajax-success-view-"+viewIndex+"-append-target")&&($target=$(r.attr("emory-form-ajax-success-view-"+viewIndex+"-append-target")),$target.append($newView)),r.attr("emory-form-ajax-success-view-"+viewIndex+"-fire-event")?h($newView,r.attr("emory-form-transition"),function(){$newView.trigger(r.attr("emory-form-ajax-success-view-"+viewIndex+"-fire-event"))}):h($newView,r.attr("emory-form-transition"));return $slideDownQueue.length?void h($slideDownQueue,r.attr("emory-form-transition"),function(){c(t,r)}):c(t,r)}function c(t,r){return r.attr("emory-form-ajax-success-post-hide-target")?void p($(r.attr("emory-form-ajax-success-post-hide-target")),r.attr("emory-form-transition"),function(){return l(t,r)}):l(t,r)}function l(t,r){return r.attr("emory-form-ajax-success-post-show-target")?void h($(r.attr("emory-form-ajax-success-post-show-target")),r.attr("emory-form-transition"),function(){return d(t,r)}):d(t,r)}function d(t,r){r.attr("emory-form-ajax-success-callback")&&window[r.attr("emory-form-ajax-success-callback")](t,r)}function y(t,r,e,a,o){e||(e="info"),o||(o=function(){});var n=$('<div data-alert="" class="alert-box '+e+'">'+r+'<a href="#" class="close">Ã—</a></div>');n.css("display","none"),t.prepend(n),h(n,a,o)}function g(t,r){t.children(".alert-box").each(function(){var t=$(this);p(t,r,function(){t.remove()})})}function p(t,r,e){return(!r||Array("slide","fade").indexOf(r)<0)&&(r="slide"),e||(e=function(){}),"slide"==r?t.slideUp().promise().done(e):"fade"==r?t.fadeOut().promise().done(e):void 0}function h(t,r,e){return(!r||Array("slide","fade").indexOf(r)<0)&&(r="slide"),e||(e=function(){}),"slide"==r?t.slideDown().promise().done(e):"fade"==r?t.fadeIn().promise().done(e):void 0}$(document).on("click","[emory-form-click-submit]",function(t){t.preventDefault(),e($(this))}),$(document).on("change","[emory-form-change-submit]",function(t){t.preventDefault(),e($(this))}),$(document).on("keydown","[emory-form-enter-submit]",function(t){var r=t.keyCode||t.which;return 13==r?(e($(this)),!1):void 0}),$(document).on("valid.fndtn.abide","[emory-form-abide-submit]",function(){e($(this))}),setInterval(function(){t()},5e3),$("[emory-form-onload-submit]").each(function(){var t=$(this);$loadingTarget=!1,$loadingTarget=t.attr("emory-form-loading-target")?$(t.attr("emory-form-loading-target")):t.parent(),$loadingTarget.addClass("emory-loading"),t.is("[emory-form-ajax]")?a(t):t.submit()})});